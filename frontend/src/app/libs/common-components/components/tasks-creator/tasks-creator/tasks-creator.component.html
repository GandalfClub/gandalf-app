<form [formGroup]="taskCreatorControl" class="tasks-creator">
  <ng-container *ngIf="!isListEmpty; else emptyList">
    <div class="tasks-creator__header event-gradient" style="color: white">

      <div *ngIf="!isTaskNameEditMode">
        <span class="tasks-creator__task-name">{{ taskName }}</span>
        <app-icon-button
          (click)="isTaskNameEditMode = true"
          [type]="'basic'"
          [startIcon]="'mode'"
          [iconSize]="'small'">
        </app-icon-button>
      </div>

      <div *ngIf="isTaskNameEditMode">

        <app-input [formControlName]="'taskNameControl'"
                   [noPaddings]="true"
                   [placeholder]="('TASK-CREATION.TASK_NAME_PLACEHOLDER' | translate)"></app-input>

        <app-icon-button
          (click)="isTaskNameEditMode = false"
          [type]="'basic'"
          [startIcon]="'done'"
          [iconSize]="'small'">
        </app-icon-button>
        <app-icon-button
          (click)="clearTaskName()"
          [type]="'basic'"
          [startIcon]="'close'"
          [iconSize]="'small'">
        </app-icon-button>

      </div>

      <app-icon-button
        [type]="'basic'"
        [startIcon]="'delete'"
        [iconSize]="'small'">
      </app-icon-button>
    </div>
    <div class="tasks-creator__body">

      <div class="tasks-creator__basic-settings">

        <mat-form-field appearance="outline">
          <mat-label>{{ 'TASK-CREATION.TASK_TYPE_LABEL' | translate }}</mat-label>
          <mat-select disableOptionCentering formControlName="selectedTaskTypeControl"
                      (openedChange)="onOpenTaskTypesSelector($event)" [value]="taskTypesEnum.single">
            <mat-option *ngFor="let taskType of tasksTypes;" [value]="taskType">
              {{ 'TASK-CREATION.TASKS_TYPES.' + taskType | translate }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <div class="tasks-creator__mentor-score-container">
          <app-slide-toggle
            class="tasks-creator__mentor-check"
            [labelPosition]="'before'"
            [disabled]="isMentorCheckDisabled()"
            formControlName="mentorCheckControl"
            [title]="('TASK-CREATION.MENTOR_CHECK_TOGGLE' | translate)">
          </app-slide-toggle>
          <app-input
            [type]="'number'"
            [formControlName]="'maxScoreControl'"
            [placeholder]="('TASK-CREATION.MAX_SCORE_PLACEHOLDER' | translate)">
          </app-input>
        </div>

      </div>

      <app-ckeditor formControlName="textEditorControl"
                    theme=lightTheme
                    [title]="'LABEL.PRIVATE_EVENT' | translate"></app-ckeditor>

      <ng-container [ngSwitch]="getSelectedTaskType()">

        <ng-container *ngSwitchCase="taskTypesEnum.single">
          <mat-radio-group formControlName="correctSingleAnswerControl">
            <div formArrayName="answersArrayControl">
              <div *ngFor="let answer of singleAnswersControl.controls; let i = index" [formGroupName]="i">
                <mat-radio-button value="{{ i.toString() }}"></mat-radio-button>
                <app-input formControlName="label"
                           [label]="( 'TASK-CREATION.TASK_TYPE_LABEL' | translate )"></app-input>
                <app-button (click)="removeSingleAnswer(i)">
                  <app-icon [icon]="'delete'"></app-icon>
                </app-button>
              </div>
            </div>
          </mat-radio-group>

          <app-button (click)="addSingleAnswer()">
            <app-icon [icon]="'add'"></app-icon>
            {{ 'TASK-CREATION.ADD_NEW_OPTION_TITLE' | translate }}
          </app-button>

        </ng-container>

        <ng-container *ngSwitchCase="taskTypesEnum.coding">
          <div style="height: 500px; display:block;">
            <app-monaco-editor
              [language]="'javascript'"
              [code]="code"
              formControlName="codeEditorControl"
              (codeChange)="updateCode($event)">
            </app-monaco-editor>
          </div>
        </ng-container>

        <ng-container *ngSwitchCase="taskTypesEnum.multiple">
          <div formArrayName="multiAnswersArrayControl">
            <div *ngFor="let answer of multiAnswerControl.controls; let i = index" [formGroupName]="i">
              <mat-checkbox [value]="i.toString()" formControlName="isCorrect"></mat-checkbox>
              <app-input formControlName="value"
                         [label]="( 'TASK-CREATION.TASK_TYPE_LABEL' | translate )"></app-input>
              <app-button (click)="removeMultiAnswer(i)">
                <app-icon [icon]="'delete'"></app-icon>
              </app-button>
            </div>
          </div>

          <app-icon-button [startIcon]="'add'">
            {{ 'TASK-CREATION.ADD_NEW_OPTION_TITLE' | translate }}
          </app-icon-button>

        </ng-container>

      </ng-container>
    </div>
  </ng-container>
</form>

<button (click)="submitTask()" style="display: block; margin-bottom: 400px;">====================</button>

<ng-template #emptyList>
  <div class="tasks-creator__empty">
    <span>{{ 'TASK-CREATION.EMPTY_TASKS_LIST' | translate }}</span>
  </div>
</ng-template>
